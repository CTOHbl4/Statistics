diag_inter.x <- (center.x + center.y)/2
ref.left <- pair.dist$conf.int[2]
ref.right <- pair.dist$conf.int[1]
real.left.x <- diag_inter.x - ref.left/2
real.right.x <- diag_inter.x - ref.right/2
real.left.y <- -real.left.x + center.x + center.y
real.right.y <- -real.right.x + center.x + center.y
type <- "different"
if (real.right.y < real.right.x)
{
type <- "same"
}
points.df <- rbind(points.df, c(real.left.x, real.left.y, type, group_count))
points.df <- rbind(points.df, c(real.right.x, real.right.y, type, group_count))
group_count <- group_count + 1
}
}
colnames(points.df) <- c("x", "y", "type", "group")
points.df$x <- as.numeric(points.df$x)
points.df$y <- as.numeric(points.df$y)
print(points.df)
a <- ggplot(points.df, aes(x, y, group = group)) +
geom_line(aes(color=type, linetype=type)) + geom_abline(linetype="dashed", color="grey") +
xlim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
ylim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
scale_color_manual(values=c('blue','red')) +
geom_vline(xintercept = categories.means, linetype="dashed", color="grey") +
geom_hline(yintercept = categories.means, linetype="dashed", color="grey") +
theme(panel.background = element_blank(), panel.grid.major = element_blank()) +
geom_text(aes(categories.means, 0, label=categories, hjust=-1))
a
}
my.diffogram(Norm.same.var.df$MPG_Highway, Norm.same.var.df$Type, Norm.same.var.df, alpha)
#_________________________________________________________________________________________________
# №3
# реализовать свою диффограмму.
# слой со шкалами от target + слой с диагональю + слой с решёткой по средним по категориям +
# + по слою на каждую категорию
my.diffogram <- function(target, categoric, df, alpha) {
categories <- unique(categoric)
categories.means <- c()
n <- length(categories)
for (i in 1:n)
{
categories.means <- append(categories.means, mean(subset(target, (categoric == categories[i]))))
}
ord <- sort(categories.means, decreasing = TRUE, index.return=TRUE)
categories.means <- ord$x
ord <- ord$ix
categories <- categories[order(ord)]
# сортировка гарантирует, что разность средних больше/равна 0.
group_count <- 1
points.df <- new("data.frame")
for (i in 1:(n-1))
{
c1 <- subset(target, (categoric == categories[i]))
for (j in (i+1):n)
{
c2 <- subset(target, (categoric == categories[j]))
pair.dist <- t.test(c1, c2, conf.level=1-alpha)
# Ищем координаты концов каждого отрезка.
center.x <- categories.means[j]
center.y <- categories.means[i]
diag_inter.x <- (center.x + center.y)/2
ref.left <- pair.dist$conf.int[2]
ref.right <- pair.dist$conf.int[1]
real.left.x <- diag_inter.x - ref.left/2
real.right.x <- diag_inter.x - ref.right/2
real.left.y <- -real.left.x + center.x + center.y
real.right.y <- -real.right.x + center.x + center.y
type <- "different"
if (real.right.y < real.right.x)
{
type <- "same"
}
points.df <- rbind(points.df, c(real.left.x, real.left.y, type, group_count))
points.df <- rbind(points.df, c(real.right.x, real.right.y, type, group_count))
group_count <- group_count + 1
}
}
colnames(points.df) <- c("x", "y", "type", "group")
points.df$x <- as.numeric(points.df$x)
points.df$y <- as.numeric(points.df$y)
print(points.df)
a <- ggplot(points.df, aes(x, y, group = group)) +
geom_line(aes(color=type, linetype=type)) + geom_abline(linetype="dashed", color="grey") +
xlim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
ylim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
scale_color_manual(values=c('blue','red')) +
geom_vline(xintercept = categories.means, linetype="dashed", color="grey") +
geom_hline(yintercept = categories.means, linetype="dashed", color="grey") +
theme(panel.background = element_blank(), panel.grid.major = element_blank()) +
geom_text(aes(categories.means, label=categories, hjust=-1))
a
}
my.diffogram(Norm.same.var.df$MPG_Highway, Norm.same.var.df$Type, Norm.same.var.df, alpha)
#_________________________________________________________________________________________________
# №3
# реализовать свою диффограмму.
# слой со шкалами от target + слой с диагональю + слой с решёткой по средним по категориям +
# + по слою на каждую категорию
my.diffogram <- function(target, categoric, df, alpha) {
categories <- unique(categoric)
categories.means <- c()
n <- length(categories)
for (i in 1:n)
{
categories.means <- append(categories.means, mean(subset(target, (categoric == categories[i]))))
}
ord <- sort(categories.means, decreasing = TRUE, index.return=TRUE)
categories.means <- ord$x
ord <- ord$ix
categories <- categories[order(ord)]
# сортировка гарантирует, что разность средних больше/равна 0.
group_count <- 1
points.df <- new("data.frame")
for (i in 1:(n-1))
{
c1 <- subset(target, (categoric == categories[i]))
for (j in (i+1):n)
{
c2 <- subset(target, (categoric == categories[j]))
pair.dist <- t.test(c1, c2, conf.level=1-alpha)
# Ищем координаты концов каждого отрезка.
center.x <- categories.means[j]
center.y <- categories.means[i]
diag_inter.x <- (center.x + center.y)/2
ref.left <- pair.dist$conf.int[2]
ref.right <- pair.dist$conf.int[1]
real.left.x <- diag_inter.x - ref.left/2
real.right.x <- diag_inter.x - ref.right/2
real.left.y <- -real.left.x + center.x + center.y
real.right.y <- -real.right.x + center.x + center.y
type <- "different"
if (real.right.y < real.right.x)
{
type <- "same"
}
points.df <- rbind(points.df, c(real.left.x, real.left.y, type, group_count))
points.df <- rbind(points.df, c(real.right.x, real.right.y, type, group_count))
group_count <- group_count + 1
}
}
colnames(points.df) <- c("x", "y", "type", "group")
points.df$x <- as.numeric(points.df$x)
points.df$y <- as.numeric(points.df$y)
print(points.df)
a <- ggplot(points.df, aes(x, y, group = group)) +
geom_line(aes(color=type, linetype=type)) + geom_abline(linetype="dashed", color="grey") +
xlim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
ylim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
scale_color_manual(values=c('blue','red')) +
geom_vline(xintercept = categories.means, linetype="dashed", color="grey") +
geom_hline(yintercept = categories.means, linetype="dashed", color="grey") +
theme(panel.background = element_blank(), panel.grid.major = element_blank())
for (i in 1:n)
{
a <- a + annotate("", x=categories.means[i], y=min(min(points.df$x), min(points.df$y)), label=categories[i])
a <= a + annotate("", x=min(min(points.df$x), min(points.df$y)), y=categories.means[i], label=categories[i])
}
a
}
my.diffogram(Norm.same.var.df$MPG_Highway, Norm.same.var.df$Type, Norm.same.var.df, alpha)
#_________________________________________________________________________________________________
# №3
# реализовать свою диффограмму.
# слой со шкалами от target + слой с диагональю + слой с решёткой по средним по категориям +
# + по слою на каждую категорию
my.diffogram <- function(target, categoric, df, alpha) {
categories <- unique(categoric)
categories.means <- c()
n <- length(categories)
for (i in 1:n)
{
categories.means <- append(categories.means, mean(subset(target, (categoric == categories[i]))))
}
ord <- sort(categories.means, decreasing = TRUE, index.return=TRUE)
categories.means <- ord$x
ord <- ord$ix
categories <- categories[order(ord)]
# сортировка гарантирует, что разность средних больше/равна 0.
group_count <- 1
points.df <- new("data.frame")
for (i in 1:(n-1))
{
c1 <- subset(target, (categoric == categories[i]))
for (j in (i+1):n)
{
c2 <- subset(target, (categoric == categories[j]))
pair.dist <- t.test(c1, c2, conf.level=1-alpha)
# Ищем координаты концов каждого отрезка.
center.x <- categories.means[j]
center.y <- categories.means[i]
diag_inter.x <- (center.x + center.y)/2
ref.left <- pair.dist$conf.int[2]
ref.right <- pair.dist$conf.int[1]
real.left.x <- diag_inter.x - ref.left/2
real.right.x <- diag_inter.x - ref.right/2
real.left.y <- -real.left.x + center.x + center.y
real.right.y <- -real.right.x + center.x + center.y
type <- "different"
if (real.right.y < real.right.x)
{
type <- "same"
}
points.df <- rbind(points.df, c(real.left.x, real.left.y, type, group_count))
points.df <- rbind(points.df, c(real.right.x, real.right.y, type, group_count))
group_count <- group_count + 1
}
}
colnames(points.df) <- c("x", "y", "type", "group")
points.df$x <- as.numeric(points.df$x)
points.df$y <- as.numeric(points.df$y)
print(points.df)
a <- ggplot(points.df, aes(x, y, group = group)) +
geom_line(aes(color=type, linetype=type)) + geom_abline(linetype="dashed", color="grey") +
xlim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
ylim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
scale_color_manual(values=c('blue','red')) +
geom_vline(xintercept = categories.means, linetype="dashed", color="grey") +
geom_hline(yintercept = categories.means, linetype="dashed", color="grey") +
theme(panel.background = element_blank(), panel.grid.major = element_blank())
for (i in 1:n)
{
a <- a + annotate("", x=categories.means[i], y=min(min(points.df$x), min(points.df$y)), label=categories[i])
a <- a + annotate("", x=min(min(points.df$x), min(points.df$y)), y=categories.means[i], label=categories[i])
}
a
}
my.diffogram(Norm.same.var.df$MPG_Highway, Norm.same.var.df$Type, Norm.same.var.df, alpha)
#_________________________________________________________________________________________________
# №3
# реализовать свою диффограмму.
# слой со шкалами от target + слой с диагональю + слой с решёткой по средним по категориям +
# + по слою на каждую категорию
my.diffogram <- function(target, categoric, df, alpha) {
categories <- unique(categoric)
categories.means <- c()
n <- length(categories)
for (i in 1:n)
{
categories.means <- append(categories.means, mean(subset(target, (categoric == categories[i]))))
}
ord <- sort(categories.means, decreasing = TRUE, index.return=TRUE)
categories.means <- ord$x
ord <- ord$ix
categories <- categories[order(ord)]
# сортировка гарантирует, что разность средних больше/равна 0.
group_count <- 1
points.df <- new("data.frame")
for (i in 1:(n-1))
{
c1 <- subset(target, (categoric == categories[i]))
for (j in (i+1):n)
{
c2 <- subset(target, (categoric == categories[j]))
pair.dist <- t.test(c1, c2, conf.level=1-alpha)
# Ищем координаты концов каждого отрезка.
center.x <- categories.means[j]
center.y <- categories.means[i]
diag_inter.x <- (center.x + center.y)/2
ref.left <- pair.dist$conf.int[2]
ref.right <- pair.dist$conf.int[1]
real.left.x <- diag_inter.x - ref.left/2
real.right.x <- diag_inter.x - ref.right/2
real.left.y <- -real.left.x + center.x + center.y
real.right.y <- -real.right.x + center.x + center.y
type <- "different"
if (real.right.y < real.right.x)
{
type <- "same"
}
points.df <- rbind(points.df, c(real.left.x, real.left.y, type, group_count))
points.df <- rbind(points.df, c(real.right.x, real.right.y, type, group_count))
group_count <- group_count + 1
}
}
colnames(points.df) <- c("x", "y", "type", "group")
points.df$x <- as.numeric(points.df$x)
points.df$y <- as.numeric(points.df$y)
print(points.df)
a <- ggplot(points.df, aes(x, y, group = group)) +
geom_line(aes(color=type, linetype=type)) + geom_abline(linetype="dashed", color="grey") +
xlim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
ylim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
scale_color_manual(values=c('blue','red')) +
geom_vline(xintercept = categories.means, linetype="dashed", color="grey") +
geom_hline(yintercept = categories.means, linetype="dashed", color="grey") +
theme(panel.background = element_blank(), panel.grid.major = element_blank())
for (i in 1:n)
{
a <- a + annotate("text", x=categories.means[i], y=min(min(points.df$x), min(points.df$y)), label=categories[i])
a <- a + annotate("text", x=min(min(points.df$x), min(points.df$y)), y=categories.means[i], label=categories[i])
}
a
}
my.diffogram(Norm.same.var.df$MPG_Highway, Norm.same.var.df$Type, Norm.same.var.df, alpha)
#_________________________________________________________________________________________________
# №3
# реализовать свою диффограмму.
# слой со шкалами от target + слой с диагональю + слой с решёткой по средним по категориям +
# + по слою на каждую категорию
my.diffogram <- function(target, categoric, df, alpha) {
categories <- unique(categoric)
categories.means <- c()
n <- length(categories)
for (i in 1:n)
{
categories.means <- append(categories.means, mean(subset(target, (categoric == categories[i]))))
}
ord <- sort(categories.means, decreasing = TRUE, index.return=TRUE)
categories.means <- ord$x
ord <- ord$ix
categories <- categories[order(ord)]
# сортировка гарантирует, что разность средних больше/равна 0.
group_count <- 1
points.df <- new("data.frame")
for (i in 1:(n-1))
{
c1 <- subset(target, (categoric == categories[i]))
for (j in (i+1):n)
{
c2 <- subset(target, (categoric == categories[j]))
pair.dist <- t.test(c1, c2, conf.level=1-alpha)
# Ищем координаты концов каждого отрезка.
center.x <- categories.means[j]
center.y <- categories.means[i]
diag_inter.x <- (center.x + center.y)/2
ref.left <- pair.dist$conf.int[2]
ref.right <- pair.dist$conf.int[1]
real.left.x <- diag_inter.x - ref.left/2
real.right.x <- diag_inter.x - ref.right/2
real.left.y <- -real.left.x + center.x + center.y
real.right.y <- -real.right.x + center.x + center.y
type <- "different"
if (real.right.y < real.right.x)
{
type <- "same"
}
points.df <- rbind(points.df, c(real.left.x, real.left.y, type, group_count))
points.df <- rbind(points.df, c(real.right.x, real.right.y, type, group_count))
group_count <- group_count + 1
}
}
colnames(points.df) <- c("x", "y", "type", "group")
points.df$x <- as.numeric(points.df$x)
points.df$y <- as.numeric(points.df$y)
print(points.df)
a <- ggplot(points.df, aes(x, y, group = group)) +
geom_line(aes(color=type, linetype=type)) + geom_abline(linetype="dashed", color="grey") +
xlim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
ylim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
scale_color_manual(values=c('blue','red')) +
geom_vline(xintercept = categories.means, linetype="dashed", color="grey") +
geom_hline(yintercept = categories.means, linetype="dashed", color="grey") +
theme(panel.background = element_blank(), panel.grid.major = element_blank())
for (i in 1:n)
{
a <- a + annotate("text", x=categories.means[i], y=min(min(points.df$x), min(points.df$y)), label=categories[i])
a <- a + annotate("text", x=max(max(points.df$x), max(points.df$y)), y=categories.means[i], label=categories[i])
}
a
}
my.diffogram(Norm.same.var.df$MPG_Highway, Norm.same.var.df$Type, Norm.same.var.df, alpha)
PDIFF(Norm.same.var.df$MPG_Highway~Norm.same.var.df$Type, Data=Norm.same.var.df, adj="tukey", conf.level=1-alpha, PLOT=TRUE)
#_________________________________________________________________________________________________
# №3
# реализовать свою диффограмму.
# слой со шкалами от target + слой с диагональю + слой с решёткой по средним по категориям +
# + по слою на каждую категорию
my.diffogram <- function(target, categoric, df, alpha) {
categories <- unique(categoric)
categories.means <- c()
n <- length(categories)
for (i in 1:n)
{
categories.means <- append(categories.means, mean(subset(target, (categoric == categories[i]))))
}
ord <- sort(categories.means, decreasing = TRUE, index.return=TRUE)
categories.means <- ord$x
ord <- ord$ix
categories <- categories[order(ord)]
# сортировка гарантирует, что разность средних больше/равна 0.
group_count <- 1
points.df <- new("data.frame")
for (i in 1:(n-1))
{
c1 <- subset(target, (categoric == categories[i]))
for (j in (i+1):n)
{
c2 <- subset(target, (categoric == categories[j]))
pair.dist <- t.test(c1, c2, conf.level=1-alpha)
# Ищем координаты концов каждого отрезка.
center.x <- categories.means[j]
center.y <- categories.means[i]
diag_inter.x <- (center.x + center.y)/2
ref.left <- pair.dist$conf.int[2]
ref.right <- pair.dist$conf.int[1]
real.left.x <- diag_inter.x - ref.left/2
real.right.x <- diag_inter.x - ref.right/2
real.left.y <- -real.left.x + center.x + center.y
real.right.y <- -real.right.x + center.x + center.y
type <- "different"
if (real.right.y < real.right.x)
{
type <- "same"
}
points.df <- rbind(points.df, c(real.left.x, real.left.y, type, group_count))
points.df <- rbind(points.df, c(real.right.x, real.right.y, type, group_count))
group_count <- group_count + 1
}
}
colnames(points.df) <- c("x", "y", "type", "group")
points.df$x <- as.numeric(points.df$x)
points.df$y <- as.numeric(points.df$y)
print(points.df)
a <- ggplot(points.df, aes(x, y, group = group)) +
geom_line(aes(color=type, linetype=type)) + geom_abline(linetype="dashed", color="grey") +
xlim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
ylim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
scale_color_manual(values=c('blue','red')) +
geom_vline(xintercept = categories.means, linetype="dashed", color="grey") +
geom_hline(yintercept = categories.means, linetype="dashed", color="grey") +
theme(panel.background = element_blank(), panel.grid.major = element_blank())
for (i in 1:n)
{
a <- a + annotate("text", x=categories.means[i], y=min(min(points.df$x), min(points.df$y)), label=categories[i])
a <- a + annotate("text", x=max(max(points.df$x), max(points.df$y)), y=categories.means[i], label=categories[i])
}
a
}
my.diffogram(Norm.same.var.df$MPG_Highway, Norm.same.var.df$Type, Norm.same.var.df, alpha)
my.diffogram(MPG_Highway, Type, df, alpha)
1
my.diffogram(MPG_Highway, Origin, df, alpha)
# Итоговая модель - модель с различимыми Type и Origin
res.lm <- lm(MPG_Highway~sample.different$Type+Origin)
summary(res.lm)
# Итоговая модель - модель с Type и Origin
summary(lm.type.origin)
my.diffogram(MPG_Highway, Type, df, alpha)
my.diffogram(MPG_Highway, Origin, df, alpha)
my.diffogram(MPG_Highway, Type, df, alpha)
#_________________________________________________________________________________________________
# №3
# реализовать свою диффограмму.
# слой со шкалами от target + слой с диагональю + слой с решёткой по средним по категориям +
# + по слою на каждую категорию
my.diffogram <- function(target, categoric, df, alpha) {
categories <- unique(categoric)
categories.means <- c()
n <- length(categories)
for (i in 1:n)
{
categories.means <- append(categories.means, mean(subset(target, (categoric == categories[i]))))
}
ord <- sort(categories.means, decreasing = TRUE, index.return=TRUE)
categories.means <- ord$x
ord <- ord$ix
categories <- categories[order(ord)]
# сортировка гарантирует, что разность средних больше/равна 0.
group_count <- 1
points.df <- new("data.frame")
# ищем концы отрезков и записываем в data.frame
for (i in 1:(n-1))
{
c1 <- subset(target, (categoric == categories[i]))
for (j in (i+1):n)
{
c2 <- subset(target, (categoric == categories[j]))
pair.dist <- t.test(c1, c2, conf.level=1-alpha)
# Ищем координаты концов каждого отрезка.
center.x <- categories.means[j]
center.y <- categories.means[i]
diag_inter.x <- (center.x + center.y)/2
ref.left <- pair.dist$conf.int[2]
ref.right <- pair.dist$conf.int[1]
real.left.x <- diag_inter.x - ref.left/2
real.right.x <- diag_inter.x - ref.right/2
real.left.y <- -real.left.x + center.x + center.y
real.right.y <- -real.right.x + center.x + center.y
type <- "different"
if (real.right.y < real.right.x)
{
type <- "same"
}
points.df <- rbind(points.df, c(real.left.x, real.left.y, type, group_count))
points.df <- rbind(points.df, c(real.right.x, real.right.y, type, group_count))
group_count <- group_count + 1
}
}
colnames(points.df) <- c("x", "y", "type", "group")
points.df$x <- as.numeric(points.df$x)
points.df$y <- as.numeric(points.df$y)
a <- ggplot(points.df, aes(x, y, group = group)) +
geom_line(aes(color=type, linetype=type)) + geom_abline(linetype="dashed", color="grey") +
xlim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
ylim(min(min(points.df$x), min(points.df$y))-1, max(max(points.df$x), max(points.df$y))+1) +
scale_color_manual(values=c('blue','red')) +
geom_vline(xintercept = categories.means, linetype="dashed", color="grey") +
geom_hline(yintercept = categories.means, linetype="dashed", color="grey") +
theme(panel.background = element_blank(), panel.grid.major = element_blank())
for (i in 1:n)
{
a <- a + annotate("text", x=categories.means[i], y=min(min(points.df$x), min(points.df$y)), label=categories[i])
a <- a + annotate("text", x=max(max(points.df$x), max(points.df$y)), y=categories.means[i], label=categories[i])
}
a
}
my.diffogram(MPG_Highway, Type, df, alpha)
my.diffogram(MPG_Highway, Origin, df, alpha)
my.diffogram(MPG_Highway, Type, df, alpha)
